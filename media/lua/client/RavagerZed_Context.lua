

--[[██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                        				 Custom  PZ  Mod  Developer  for  Hire													  |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                       	Portfolio:  https://steamcommunity.com/id/glytch3r/myworkshopfiles/							          |
|                       		                                    														 	  |
|                       	Discord:     glytch3r															      |
|                       		                                    														 	  |
|                       	Support:    https://ko-fi.com/glytch3r														    	  |
|_______________________________________________________________________________________________________________________________-]]
--[[_____________________________________________________________________________________________________________________________
   ░▒▓██████▓▒░    ░▒▓████████▓▒░    ░▒▓█▓▒░         ░▒▓█▓▒░      ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░           ░▒▓█▓▒░         ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓▒░
  ░▒▓█▓▒▒▓███▓▒░   ░▒▓█▓▒░         ░▒▓██████▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█████████▓▒░     ░▒▓███▓▒░     ░▒▓███████▓▒░
  ░▒▓█▓▒░          ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░         ░▒▓█▓▒░ ░▒▓█▓▒░         ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
  ░▒▓█▓▒░░▒▓█▓▒░   ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░     ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓█▓▒░ ░▒▓█▓▒░  ▒▓░    ░▒▓█▓▒░   ░▒▓█▒░  ░▒▓█▒░
   ░▒▓█████▓▒░     ░▒▓█▓▒░        ░▒▓█▓▒░░▒▓█▓▒░  ░▒▓███████▓▒░   ░▒▓██████▓▒░   ░▒▓█▓▒░ ░▒▓█▓▒░  ░▒▓███████▓▒░    ░▒▓███████▓▒░
█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████--]]

RavagerZed = RavagerZed or {}



-----------------------     context*          ---------------------------







function RavagerZed.invContext(player, context, items)
	local pl = getSpecificPlayer(player)
    if isAdmin() then return end
	local inv = pl:getInventory()
	local item = inv:FindAndReturn("Base.RavagerZed")
	if item then
		local plNum = pl:getPlayerNum()
		ISRemoveItemTool.removeItem(item, plNum)

	end
end

Events.OnFillInventoryObjectContextMenu.Remove(RavagerZed.invContext)
Events.OnFillInventoryObjectContextMenu.Add(RavagerZed.invContext);




function RavagerZed.Context(player, context, worldobjects)
	local pl = getSpecificPlayer(player)
	local sq = clickedSquare

	if (getCore():getDebug() or isAdmin()) then

		local Main = context:addOption(getText("ContextMenu_RavagerZed_Debug"))
		Main.iconTexture = getTexture("media/ui/RavagerZed_Context.png")
		local opt = ISContextMenu:getNew(context)
		context:addSubMenu(Main, opt)

		-----------------------            ---------------------------

		local SkinSub = opt:addOption(getText("ContextMenu_RavagerZed_Skin"))
		local Skinopt = ISContextMenu:getNew(context)
		opt:addSubMenu(SkinSub, Skinopt)

		local optTip1 = Skinopt:addOption(getText("ContextMenu_RavagerZed_WearSkin"), worldobjects, function()
            RavagerZed.wearRavagerZed(pl)
            pl:getModData()['isRavagerPl'] = true
		end);
		local optTip2 = Skinopt:addOption(getText("ContextMenu_RavagerZed_RemoveSkin"), worldobjects, function()
			RavagerZed.clearRavagerZedSkin(pl)
			pl:getModData()['isRavagerPl'] = false
		end);

		if RavagerZed.isRavagerPl(pl) then
			optTip1.notAvailable = true
		else
			optTip2.notAvailable = true
		end

		-----------------------            ---------------------------

		local SpawnSub = opt:addOption(getText("ContextMenu_RavagerZed_Spawn"))
		local Spawnopt = ISContextMenu:getNew(context)
		opt:addSubMenu(SpawnSub, Spawnopt)

		Spawnopt:addOption("x1", worldobjects, function()
			RavagerZed.doSpawn(sq, false, 'RavagerZed')
		end);


		Spawnopt:addOption("x2", worldobjects, function()
			RavagerZed.doSpawn(sq, false, 'RavagerZed')
			RavagerZed.doSpawn(sq, false, 'RavagerZed')
		end);

		Spawnopt:addOption("x3", worldobjects, function()
            for i = 1, 3 do
                RavagerZed.doSpawn(sq, false, 'RavagerZed')
            end
		end);

		Spawnopt:addOption("x5", worldobjects, function()
            for i = 1, 5  do
                RavagerZed.doSpawn(sq, false, 'RavagerZed')
            end
		end);

		Spawnopt:addOption("x10", worldobjects, function()
            for i = 1, 10  do
                RavagerZed.doSpawn(sq, false, 'RavagerZed')
            end
		end);

		Spawnopt:addOption("x15", worldobjects, function()
            for i = 1, 15  do
                RavagerZed.doSpawn(sq, false, 'RavagerZed')
            end
		end);

		-----------------------            ---------------------------
		local EmoteSub = opt:addOption(getText("ContextMenu_RavagerZed_Emote"))
		local Emoteopt = ISContextMenu:getNew(context)
		opt:addSubMenu(EmoteSub, Emoteopt)


		Emoteopt:addOption("Ravager_Taunt", worldobjects, function()
			pl:playEmote('Ravager_Taunt')
		end);

		Emoteopt:addOption("Ravager_ChokeSlam", worldobjects, function()
			pl:playEmote('Ravager_ChokeSlam')
		end);

		-----------------------            ---------------------------
		local rad = 15

		opt:addOption(getText("ContextMenu_RavagerZed_KillRavager"), worldobjects, function()
			local count = 0
			local cell = pl:getCell()
			local x, y, z = pl:getX(), pl:getY(), pl:getZ()
			for xDelta = -rad, rad do
				for yDelta = -rad, rad do
					local sq = cell:getGridSquare(x + xDelta, y + yDelta, z)
					if sq then
						local zed = sq:getZombie()
						if zed and RavagerZed.isRavagerZed(zed) then
							count = count + 1
							zed:changeState(ZombieOnGroundState.instance())
							zed:setAttackedBy(getCell():getFakeZombieForHit())
							zed:becomeCorpse()
						end
					end
				end
			end
			if count > 1 then
				print('killed '..tostring(count)..' Ravagers')
			else
				print('killed '..tostring(count)..' Ravager')
			end
		end);

		opt:addOption(getText("ContextMenu_RavagerZed_KillOther"), worldobjects, function()
			local cell = pl:getCell()
			local x, y, z = pl:getX(), pl:getY(), pl:getZ()
			for xDelta = -rad, rad do
				for yDelta = -rad, rad do
					local sq = cell:getGridSquare(x + xDelta, y + yDelta, z)
					if sq then
						local zed = sq:getZombie()
						if zed and not RavagerZed.isRavagerZed(zed) then
							zed:changeState(ZombieOnGroundState.instance())
							zed:setAttackedBy(getCell():getFakeZombieForHit())
							zed:becomeCorpse()
						end
					end
				end
			end
		end);
		local dbgOpt = opt:addOption(getText("ContextMenu_RavagerZed_DebugPrints"), worldobjects, function()
			RavagerZed.isWIP = not RavagerZed.isWIP
		end);
		context:setOptionChecked(dbgOpt, RavagerZed.isWIP)

		local whereVar = round(pl:getX()) ..':'.. round(pl:getY())
		if whereVar then
			local clipOpt = opt:addOption(getText("ContextMenu_RavagerZed_ClipXY").." "..tostring(whereVar), worldobjects, function()
				Clipboard.setClipboard(whereVar);
				local cap = "Coordinates Saved To Clipboard "..tostring(whereVar)
				print(tostring(cap))
				pl:addLineChatElement(tostring(cap))
			end)
			local tip = ISWorldObjectContextMenu.addToolTip()
			tip.description = getText("ContextMenu_RavagerZed_ClipXYTip")
			clipOpt.toolTip = tip
		end
	end
end
Events.OnFillWorldObjectContextMenu.Remove(RavagerZed.Context)
Events.OnFillWorldObjectContextMenu.Add(RavagerZed.Context)




